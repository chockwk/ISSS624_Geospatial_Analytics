---
title: "Geospatial Analytics for Public Good"
author: "Wan Kee"
date: "25 November 2023"
date modified: "25 November 2023"
format: html
execute: 
  echo: true
  eval: true
  warning: false
editor: visual
---

# 1.1 Overview

# 1.2 Load packages

```{r}
pacman::p_load(knitr, spdep, tmap, tidyverse, sf)
```

# 1.3 Import data

::: panel-tabset

The datasets are the passenger volume by origin destination bus stops.

## Aug 2023

```{r}
odbus08 = read_csv("data/origin_destination_bus_202308.csv")

odbus08$ORIGIN_PT_CODE <- as.factor(odbus08$ORIGIN_PT_CODE)
odbus08$DESTINATION_PT_CODE <- as.factor(odbus08$DESTINATION_PT_CODE)
glimpse(odbus08)
```

## Sept 2023

```{r}
odbus09 = read_csv("data/origin_destination_bus_202309.csv")

odbus09$ORIGIN_PT_CODE <- as.factor(odbus09$ORIGIN_PT_CODE)
odbus09$DESTINATION_PT_CODE <- as.factor(odbus09$DESTINATION_PT_CODE)
glimpse(odbus09)
```

## Oct 2023

```{r}
odbus10 = read_csv("data/origin_destination_bus_202310.csv")

odbus10$ORIGIN_PT_CODE <- as.factor(odbus10$ORIGIN_PT_CODE)
odbus10$DESTINATION_PT_CODE <- as.factor(odbus10$DESTINATION_PT_CODE)
glimpse(odbus10)
```

## hexagon

Master Plan 2014 Subzone Boundary

The Master Plan is a forward looking guiding plan for Singapore's development in the medium term over the next 10 to 15 years. To facilitate urban planning, the Urban Redevelopment Authority (URA) divides Singapore into regions, planning areas and subzones. Subzones are divisions within a planning area which are usually centred around a focal point such as neighbourhood centre or activity node.

`hexagon` is a hexagon layer of 250m (this distance is the perpendicular distance between the centre of the hexagon and its edges.) should be used to replace the relative coarse and irregular Master Plan 2019 Planning Sub-zone GIS data set of URA.

Source: URA (Download [here](https://beta.data.gov.sg/collections/1749/view))

```{r}
install.packages("rgdal")
install.packages("sf")
```


```{r}
# Load the GeoJSON or KML file
data <- st_read("path_to_your_file.geojson")  # or "path_to_your_file.kml"
st_write(data, "path_to_new_shapefile.shp")
```

Step 2: Create a hexagon grid over the extent of your data with 250m radius

```{r}
hex_grid <- st_make_grid(odbus08_sf, cellsize = c(250, 250 * sqrt(3)), what = "hexagons")
```

Step 3: Coerce hex_grid to an sf object and calculate the centroids if needed

```{r}
hexagon <- st_sf(geometry = hex_grid)
```

Step 4: Assign a CRS (Coordinate Reference System) to the hexagon grid if needed

```{r}
st_crs(hexagon) <- st_crs(odbus08_sf)
```

:::

# 1.4 Explore data


# 1.5 Geovisualisation and Analysis


# 1.6 Local Indicators of Spatial Association (LISA) Analysis


# 1.7 Emerging Hot Spot Analysis (EHSA)


# 1.8 Plot data


# weekday evening peak passenger trips by origin; hexagons dont not have shared boundary; isolated with no neighbours but a hotspot. hexagon is a compact shape, grid is a regular geographic unit, rarely real world reflection to overcome odd shape geographical units.
